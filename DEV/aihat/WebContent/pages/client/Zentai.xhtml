<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"   
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:t="http://myfaces.apache.org/tomahawk"
      xmlns:client="http://www.aihat.net/client">
<f:view>
<h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link rel="shortcut icon" href="favicon.png" type="image/png"/>
	<title>#{msg.aihat_title}</title>
	<style type="text/css">
		@import url("#{config.server}/css/client.css");
    </style>
    <style type="text/css">
		@import url("#{config.server}/css/ui-lightness/jquery-ui-1.8.14.custom.css");
    </style>
   <script>
	   	var currentPageIdx = 0;
		var ALL_PAGES = 
			[
				"FeaturedClips",
				"Clips",
				"Detail",
				"MyProfile",
				"Register"
			];
		function lightenPageLinkOnly(page) {
			$(".td_slideTo").css("opacity", "0.5");
			$("#td_slideTo" + page).css("opacity", "1");
		}
		function slide(slideBy) {
			var newPageIdx = currentPageIdx + slideBy;
			if(0 &lt;= newPageIdx &amp;&amp; newPageIdx &lt; ALL_PAGES.length) {
				$("#slideTo" + ALL_PAGES[newPageIdx]).click();
				currentPageIdx = newPageIdx;
			}
		}
		function slideTo(page) {
			$("#slideTo" + page).click();
			lightenPageLinkOnly(page);
		}
		function slideToDetail() {
			slideTo("Detail");
		}
		function slideToMyProfile() {
			slideTo("MyProfile");
		}
		function slideToRegister() {
			slideTo("Register");
		}
		function slideToFeaturedClips() {
			slideTo("FeaturedClips");
		}
		function getPageIdxOf(pageName, prefix) {
			for(var i = 0; i &lt; ALL_PAGES.length; i++) {
				if(pageName == prefix + ALL_PAGES[i]) {
					return i;
				}
			}
			return -1;
		}
		
	   function boundLinkToPage() {
			$('#UpperPanel .pagelink').click(function () {
				$('#wrapper .page').removeClass('selected');
				$('#wrapper').scrollTo($(this).attr('href'), 400);		
				$(this).addClass('selected');
				currentPageIdx = getPageIdxOf($(this).attr('href'), "#");
				return false;
			});
		}
		function resizeLayout() {
			width = $(window).width();
			height = $(window).height() - 99;
			
			mask_width = width * $('#wrapper .page').length;
			$('#wrapper, .page').css({width: width, height: height});
			$('#wrapper').css({width: width, height: height});
			$('#mask').css({width: mask_width, height: height});
		}
	</script>
</h:head>
<h:body>
	<f:loadBundle basename="#{userProfileBean.languageBundle}" var="msg"/>
	<f:loadBundle basename="configurations" var="config"></f:loadBundle>
	<script src="#{config.server}/js/jquery-1.5.1.min.js" type="text/javascript"></script>
	<script src="#{config.server}/js/jquery.scrollTo.js" type="text/javascript"></script>
	<script src="#{config.server}/js/jquery-ui-1.8.14.custom.min.js" type="text/javascript"></script>
	<script src="#{config.server}/js/reflection.js" type="text/javascript"></script>
	<script src="#{config.server}/js/common.js" type="text/javascript"></script>
	<script src="#{config.server}/js/client.js" type="text/javascript"></script>
	<script src="#{config.server}/js/google-jsapi.js" type="text/javascript"></script>
	<script src="#{config.server}/js/swfobject_2.1.js" type="text/javascript"></script>
	<script src="http://connect.facebook.net/en_US/all.js#xfbml=1"></script>
	
	<!-- PAGES -->
	<div id="wrapper" style="top:99px;">
		<div id="mask">
			<div id="FeaturedClips" class="page" align="center">
				<ui:insert>
					<ui:include src="FeaturedClips.xhtml"/>
				</ui:insert>
			</div>
			<div id="Clips" class="page" align="center">
				<ui:insert>
					<ui:include src="Clips.xhtml"/>
				</ui:insert>
			</div>
			<div id="Detail" class="page" align="center">
				<ui:insert>
					<ui:include src="Detail.xhtml"/>
				</ui:insert>
			</div>
			<div id="MyProfile" class="page" align="center">
				<ui:insert>
					<ui:include src="MyProfile.xhtml"/>
				</ui:insert>
			</div>
			<div id="Register" class="page" align="center">
				<ui:insert>
					<ui:include src="Register.xhtml"/>
				</ui:insert>
			</div>
		</div>
	</div>
	
	<!-- UPPER PANEL -->
	<div id="UpperPanel" align="center">
		<h:form id="login">
			<a id="slideToDetail" href="#Detail" class="pagelink"></a>
			<a id="slideToRegister" href="#Register" class="pagelink"></a>
			<t:div styleClass="style003">
				<h:commandLink onclick="slideToMyProfile()" style="position:absolute; top:10px;">
					<f:ajax event="click" render=":myProfile" listener="#{myProfileBean.selectNotifiedClipsTab}"/>
					<div style="color: white; underline:none;">
						<h:panelGrid columns="2">
							<img src="#{config.server}/img/client/notification.png" />
							<h:outputText value="#{zentaiBean.notifiedClipsCount}"/>
						</h:panelGrid>
					</div>
				</h:commandLink>
			</t:div>
			
			<table class="style001">
				<tr>
					<td id="td_slideToFeaturedClips" class="td_slideTo" style="opacity:0.5" >
						<t:div>
							<a id="slideToFeaturedClips" href="#FeaturedClips" class="pagelink" onclick="lightenPageLinkOnly('FeaturedClips')">
								<table cellpadding="0" cellspacing="0">
									<tr>
										<td>
											<img src="#{config.server}/img/client/FeaturedClips.png"/>
										</td>
										<td style="vertical-align: middle;">
											<div>
												<h:outputText value="#{msg.featured_clips}" styleClass="top-panel-text"/>
											</div>
										</td>
									</tr>
								</table>
							</a>
						</t:div>
					</td>
					<td id="td_slideToClips" class="td_slideTo" style="opacity:0.5" >
						<t:div>
							<a id="slideToClips" href="#Clips" class="pagelink" onclick="lightenPageLinkOnly('Clips')">
								<table cellpadding="0" cellspacing="0">
									<tr>
										<td>
											<img src="#{config.server}/img/client/Clips.png" />
										</td>
										<td style="vertical-align: middle;">
											<div>
												<h:outputText value="#{msg.search}" styleClass="top-panel-text"/>
											</div>
										</td>
									</tr>
								</table>
							</a>
						</t:div>
					</td>
					<td id="td_slideToDetail" class="td_slideTo" style="opacity:0.5" >
						<t:div>
							<a id="slideToDetail" href="#Detail" class="pagelink" onclick="lightenPageLinkOnly('Detail')"> 
								<table cellpadding="0" cellspacing="0">
									<tr>
										<td>
											<img src="#{config.server}/img/client/Detail.png" />
										</td>
										<td style="vertical-align: middle;">
											<div>
												<h:outputText value="#{msg.detail}" styleClass="top-panel-text"/>
											</div>
										</td>
									</tr>
								</table>
							</a>
						</t:div>
					</td>
					<td id="td_slideToMyProfile" class="td_slideTo" style="opacity:0.5">
						<t:div rendered="#{userProfileBean.loggedIn}">
							<a id="slideToMyProfile" href="#MyProfile" class="pagelink" onclick="lightenPageLinkOnly('MyProfile')">
								<table cellpadding="0" cellspacing="0">
									<tr>
										<td>
											<img src="#{config.server}/img/client/MyProfile.png"/>
										</td>
										<td style="vertical-align: middle;">
											<div>
												<h:outputText value="#{msg.myprofile}" styleClass="top-panel-text"/>
											</div>
										</td>
									</tr>
								</table>
							</a>
						</t:div>
					</td>
				</tr>
			</table>
			<t:div rendered="#{not userProfileBean.loggedIn}" styleClass="style002">
				<h:panelGrid columns="6">
					<h:outputText value="#{msg.login_email}"/>
					<h:inputText id="txtUsername" value="#{userProfileBean.mail}" label="#{msg.login_email}" styleClass="style004"/>
					<h:outputText value="#{msg.login_password}"/>
					<h:inputSecret id="txtPassword" value="#{userProfileBean.password}" redisplay="true" styleClass="style004"/>
					<h:commandButton value="#{msg.login_submit}" styleClass="style005">
						<f:ajax execute="@form" event="click" render="@form :clips :detail :myProfile" listener="#{userProfileBean.login}"/>
					</h:commandButton>
					<h:commandButton value="#{msg.CU0037}" onclick="slideToRegister()" styleClass="style005">
						<f:ajax event="click" render=":register" listener="#{registerBean.initAjax}"/>
					</h:commandButton>
				</h:panelGrid>
			</t:div>
			<t:div rendered="#{userProfileBean.loggedIn}" styleClass="style002">
				<h:panelGrid columns="2">
					<h:outputText value="#{msg.welcome} #{userProfileBean.profile.name}"/>
					<h:commandButton value="#{msg.logout}" styleClass="style005">
						<f:ajax event="click" render="@form :clips :detail :myProfile" listener="#{userProfileBean.logout}"/>
					</h:commandButton>
				</h:panelGrid>
			</t:div>
			<script>
				boundLinkToPage();
			</script>
			<client:messages formId="login" bean="#{userProfileBean}"/>
		</h:form>
	</div>
	<script>
		$(window).ready(function() {
			document.body.scroll = "no";
			document.documentElement.style.overflow = 'hidden';
			resizeLayout();
			boundLinkToPage();
			
			lightenPageLinkOnly('FeaturedClips');
			
			<c:if test="#{zentaiBean.pageName eq 'MyProfile'}">
				slideToMyProfile();
			</c:if>
		});
		
		$(window).resize(function () {
			resizeLayout();
		});
	</script>
	
	<script>
		$(function() {
			document.onkeypress = function(e) {
		        if ((e.which &amp;&amp; e.which == 37) || (e.keyCode &amp;&amp; e.keyCode == 37)) {
		        	slide(-1);
		            return false;
		        } else if ((e.which &amp;&amp; e.which == 39) || (e.keyCode &amp;&amp; e.keyCode == 39)) {
		        	slide(1);
		            return false;
		        } else {
		            return true;
		        }
			}
			if (document.layers)
				document.captureEvents(Event.KEYPRESS);
		});
	</script>
	
	
	<img src="#{config.server}/img/client/aihatvn.png" style="position: fixed;left: 10px;top: 10px;"/>
	
	<!-- KEEP SESSION -->
	<h:commandButton style="display:none" styleClass="btnKeepSession">
		<f:ajax event="click" listener="#{zentaiBean.keepSession}"/>
	</h:commandButton>
	<script>
		setInterval(keepSession, 60000);
		function keepSession() {
			$(".btnKeepSession").click();
		}
	</script>
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-25845475-1']);
		_gaq.push(['_trackPageview']);
		
		(function() {
		  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>
</h:body>
</f:view>
</html>
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:client="http://www.aihat.net/client">
<ui:composition>
	<table>
		<ui:repeat var="aClip" value="#{clips}">
			<tr>
				<td rowspan="2">
					<h:commandLink onclick="slideToFeaturedClips(); updateCurrentPlaybackPos();">
						<f:param name="selectedClipId" value="#{aClip.id}"/>
						<f:ajax event="click" execute=":featuredClips" render=":featuredClips" listener="#{featuredClipsBean.playOne}"/>
						<h:graphicImage url="#{aClip.thumbnailLink}" height="62"/>
					</h:commandLink>
				</td>
				<td>
					<h:outputText value="#{aClip.title}"/>
				</td>
				<td>
					<ui:repeat var="aSinger" value="#{aClip.singers}">
						<h:commandLink onclick="slideToDetail();">
							<f:param name="singerId" value="#{aSinger.id}"/>
							<f:ajax event="click" execute="@form" render=":detail" listener="#{detailBean.showSingerDetail}"/>
							<h:outputText value="#{aSinger.name}"/>
							<h:outputText value="(#{msg.CU0021})" rendered="#{aSinger.followed}"/>
						</h:commandLink>
						<br/>
					</ui:repeat>
				</td>
				<td>
					<ui:repeat var="aComposer" value="#{aClip.composers}">
						<h:commandLink value="#{aComposer.name}" onclick="slideToDetail();">
							<f:param name="composerId" value="#{aComposer.id}"/>
							<f:ajax event="click" execute="@form" render=":detail" listener="#{detailBean.showComposerDetail}"/>
						</h:commandLink>
						<br/>
					</ui:repeat>
				</td>
				<td>
					<ui:repeat var="aGenre" value="#{aClip.genres}">
						<h:commandLink value="#{aGenre.nameEn}"	rendered="#{utilsBean.currentLanguage eq 'en'}" onclick="slideToDetail();">
							<f:param name="genreId" value="#{aGenre.id}"/>
							<f:ajax event="click" execute="@form" render=":detail" listener="#{detailBean.showGenreDetail}"/>
						</h:commandLink>
						<h:commandLink value="#{aGenre.nameVi}" rendered="#{utilsBean.currentLanguage eq 'vi'}" onclick="slideToDetail();">
							<f:param name="genreId" value="#{aGenre.id}"/>
							<f:ajax event="click" execute="@form" render=":detail" listener="#{detailBean.showGenreDetail}"/>
						</h:commandLink>
						<br/>
					</ui:repeat>
				</td>
				<td>
					<h:commandLink onclick="slideToDetail();">
						<f:param name="userId" value="#{aClip.user.id}"/>
						<f:ajax event="click" execute="@form" render=":detail" listener="#{detailBean.showUserDetail}"/>
						<h:outputText value="#{aClip.user.name}"/>
						<h:outputText value="(#{msg.CU0021})" rendered="#{aClip.user.followed}"/>
					</h:commandLink>
				</td>
			</tr>
		</ui:repeat>
	</table>
	<h:dataTable var="aClip" value="#{clips}" styleClass="dataTable">
		<h:column>
			<f:facet name="header">
				<h:selectBooleanCheckbox styleClass="selectHeader" onchange="selectOnChange_header(this, '#{formId}', 'selectClipCheckBox')"/>			
			</f:facet>
			<h:selectBooleanCheckbox id="selectClipCheckBox" value="#{aClip.selectedInDataTable}" styleClass="selectClipCheckBox"
				onchange="selectOnChange_item('#{formId}', 'selectHeader', 'selectClipCheckBox')"/>
			<h:panelGrid columns="3" rendered="#{orderInPlaylistChangable}">
				<h:commandButton value="▲">
					<f:param name="clipId" value="#{aClip.id}"/>
					<f:param name="orderChangedBy" value="-1"/>
					<f:ajax event="click" render="@form" listener="#{detailBean.changeClipOrderInPlaylist}"/>
				</h:commandButton>
				<h:commandButton value="▼">
					<f:param name="clipId" value="#{aClip.id}"/>
					<f:param name="orderChangedBy" value="1"/>
					<f:ajax event="click" render="@form" listener="#{detailBean.changeClipOrderInPlaylist}"/>
				</h:commandButton>
			</h:panelGrid>
		</h:column>
		<h:column>
			<f:facet name="header">
				<h:outputText value="#{msg.client_clips_info}"/>
			</f:facet>
			<h:panelGrid columns="5">
				<h:commandLink onclick="slideToFeaturedClips(); updateCurrentPlaybackPos();">
					<f:param name="selectedClipId" value="#{aClip.id}"/>
					<f:ajax event="click" execute=":featuredClips" render=":featuredClips" listener="#{featuredClipsBean.playOne}"/>
					<h:graphicImage url="#{aClip.thumbnailLink}" width="120"/>
				</h:commandLink>
				<h:panelGrid columns="1">
					<h:outputText value="#{aClip.title}"/>
					<h:graphicImage url="#{config.server}/img/client/official.png" rendered="#{aClip.official}"/>
					<h:outputText value="#{aClip.nFans} #{msg.client_clips_peopleLiked}"/>
					<h:outputText value="#{aClip.nViews} #{msg.client_clips_peopleViewed}"/>
				</h:panelGrid>
				<h:commandButton value="+" onclick="slideToFeaturedClips();updateCurrentPlaybackPos();">
					<f:param name="selectedClipId" value="#{aClip.id}"/>
					<f:param name="referenceBeanName" value="#{bean.beanName}"/>
					<f:ajax event="click" execute=":featuredClips" render=":featuredClips" listener="#{featuredClipsBean.addOne}"/>
				</h:commandButton>
				<h:commandButton value="like" rendered="#{userProfileBean.loggedIn and not aClip.liked}">
					<f:param name="clipId" value="#{aClip.id}"/>
					<f:param name="referenceBeanName" value="#{bean.beanName}"/>
					<f:ajax event="click" render="@form" listener="#{zentaiBean.likeClip}"/>
				</h:commandButton>
				<h:commandButton value="unlike" rendered="#{userProfileBean.loggedIn and aClip.liked}">
					<f:param name="clipId" value="#{aClip.id}"/>
					<f:param name="referenceBeanName" value="#{bean.beanName}"/>
					<f:ajax event="click" render="@form" listener="#{zentaiBean.unlikeClip}"/>
				</h:commandButton>
				<h:commandButton value="Link" onclick="alert('#{config.server}/pages/client/Zentai.jsf?perlink_clipid=#{aClip.id}');return false;"/>
				
			</h:panelGrid>
		</h:column>
		<!--h:column>
			<f:facet name="header">
				<h:outputText value="#{msg.CU0038}"/>
			</f:facet>
			<script>
				document.write(
				'&lt;fb:like href="#{config.server}/pages/client/Zentai.jsf?perlink_clipid=#{aClip.id}" show_faces="false" layout="box_count"&gt;&lt;/fb:like&gt;'
						);
			</script>
		</h:column-->
		<h:column>
			<f:facet name="header">
				<h:outputText value="#{msg.client_clips_singer}"/>
			</f:facet>
			<h:panelGrid columns="1">
				<ui:repeat var="aSinger" value="#{aClip.singers}">
					<h:commandLink onclick="slideToDetail();">
						<f:param name="singerId" value="#{aSinger.id}"/>
						<f:ajax event="click" execute="@form" render=":detail" listener="#{detailBean.showSingerDetail}"/>
						<h:outputText value="#{aSinger.name}"/>
						<h:outputText value="(#{msg.CU0021})" rendered="#{aSinger.followed}"/>
					</h:commandLink>
					<br/>
				</ui:repeat>
			</h:panelGrid>
		</h:column>
		<h:column>
			<f:facet name="header">
				<h:outputText value="#{msg.client_clips_composer}"/>
			</f:facet>
			<h:panelGrid columns="1">
				<ui:repeat var="aComposer" value="#{aClip.composers}">
					<h:commandLink value="#{aComposer.name}" onclick="slideToDetail();">
						<f:param name="composerId" value="#{aComposer.id}"/>
						<f:ajax event="click" execute="@form" render=":detail" listener="#{detailBean.showComposerDetail}"/>
					</h:commandLink>
					<br/>
				</ui:repeat>
			</h:panelGrid>
		</h:column>
		<h:column>
			<f:facet name="header">
				<h:outputText value="#{msg.client_clips_genre}"/>
			</f:facet>
			<h:panelGrid columns="1">
				<ui:repeat var="aGenre" value="#{aClip.genres}">
					<h:commandLink value="#{aGenre.nameEn}"	rendered="#{utilsBean.currentLanguage eq 'en'}" onclick="slideToDetail();">
						<f:param name="genreId" value="#{aGenre.id}"/>
						<f:ajax event="click" execute="@form" render=":detail" listener="#{detailBean.showGenreDetail}"/>
					</h:commandLink>
					<h:commandLink value="#{aGenre.nameVi}" rendered="#{utilsBean.currentLanguage eq 'vi'}" onclick="slideToDetail();">
						<f:param name="genreId" value="#{aGenre.id}"/>
						<f:ajax event="click" execute="@form" render=":detail" listener="#{detailBean.showGenreDetail}"/>
					</h:commandLink>
					<br/>
				</ui:repeat>
			</h:panelGrid>
		</h:column>
		
		<h:column>
			<f:facet name="header">
				<h:outputText value="#{msg.client_clips_uploader}"/>
			</f:facet>
			<h:commandLink onclick="slideToDetail();">
				<f:param name="userId" value="#{aClip.user.id}"/>
				<f:ajax event="click" execute="@form" render=":detail" listener="#{detailBean.showUserDetail}"/>
				<h:outputText value="#{aClip.user.name}"/>
				<h:outputText value="(#{msg.CU0021})" rendered="#{aClip.user.followed}"/>
			</h:commandLink>
		</h:column>
	</h:dataTable>
	<script>
		selectOnChange_item('#{formId}', 'selectHeader', 'selectClipCheckBox');
	</script>
</ui:composition>
</html>